<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Report</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      background-attachment: fixed;
      color: #000;
      line-height: 1.5;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      z-index: -1;
    }
    .page {
      max-width: 1200px;
      margin: 40px auto;
      padding: 20px;
      background: #fff;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    h1 {
      text-align: center;
      margin: 0;
      padding-bottom: 10px;
    }
    .top-menu {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .left-menu {
      display: flex;
      gap: 3px;
    }
    .right-menu {
      display: flex;
      gap: 3px;
    }
    .top-menu-btn {
      font-size: 0.9rem;
      padding: 5px 10px;
      margin: 0 3px;
      cursor: pointer;
      border: 1px solid #ccc;
      background: #fff;
      color: #000;
      border-radius: 3px;
      min-width: 80px;
      height: 30px;
      line-height: 1.2;
    }
    .top-menu-btn:hover {
      background: #f0f0f0;
      border-color: #999;
    }
    
    /* ë…„ë„ í‘œì‹œ ìŠ¤íƒ€ì¼ */
    .year-display {
      font-size: 0.9rem;
      font-weight: 600;
      color: #000;
      min-width: 50px;
      text-align: center;
      padding: 0 5px;
      margin: 0 3px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      height: 30px;
      background: #f8f8f8;
      border: 1px solid #e0e0e0;
      border-radius: 3px;
    }
    
    /* ë…„ë„ ë²„íŠ¼ íŠ¹ë³„ ìŠ¤íƒ€ì¼ */
    .year-btn {
      min-width: 30px;
      width: 30px;
      padding: 5px;
    }

    /* ì£¼ë¬¸ ëª©ë¡ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
    .order-table-container {
      margin-top: 20px;
      overflow-x: auto;
      width: 100%;
    }
    
    #orderTable {
      width: 100%;
      min-width: 800px;
      border-collapse: collapse;
      border: 1px solid #ccc;
      table-layout: fixed;
    }
    
    #orderTable th,
    #orderTable td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      vertical-align: middle;
      width: calc(100% / 7);
    }
    
    #orderTable th {
      background-color: #f5f5f5;
      font-weight: bold;
    }
    
    #orderTable td {
      font-size: 0.9rem;
    }
    
    /* í•˜ë‹¨ ë²„íŠ¼ ì˜ì—­ ì „ì²´ - order.htmlê³¼ ë™ì¼ */
    .bottom-buttons {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #fff;
      border-top: 1px solid #e0e0e0;
      padding: 15px;
      z-index: 1000;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
    }

    /* í™•ì¥ ì†ì¡ì´ (ì„œë ì†ì¡ì´ì²˜ëŸ¼ ìœ„ìª½ì— íŠ€ì–´ë‚˜ì˜´) */
    .expand-handle {
      position: absolute;
      top: -15px;
      left: 20px;
      z-index: 10;
    }

    /* í™•ì¥/ì¶•ì†Œ ë²„íŠ¼ */
    .expand-btn {
      font-size: 0.8rem;
      padding: 4px 12px;
      cursor: pointer;
      border: 1px solid #ccc;
      background: #f8f8f8;
      color: #666;
      border-radius: 8px 8px 0 0;
      min-width: 40px;
      height: 20px;
      line-height: 1;
      transition: all 0.2s ease;
      box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
    }

    .expand-btn:hover {
      background: #e8e8e8;
      border-color: #999;
      box-shadow: 0 -3px 6px rgba(0,0,0,0.15);
    }

    .expand-btn.expanded {
      transform: rotate(180deg);
      background: #e0e0e0;
    }

    /* ê¸°ë³¸ ë²„íŠ¼ ê·¸ë£¹ ë ˆì´ì•„ì›ƒ */
    .main-button-group {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: flex-start;
      padding: 15px;
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 5px;
    }

    /* ìƒì„¸ ë²„íŠ¼ ì˜ì—­ */
    .detail-button-area {
      margin-top: 10px;
      padding: 12px;
      background: #f9f9f9;
      border: 1px solid #e0e0e0;
      border-radius: 5px;
      animation: slideDown 0.3s ease;
      display: flex;
      gap: 8px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .detail-button-area button {
      margin: 0;
    }

    /* ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }


    /* í…Œì´ë¸” í•˜ë‹¨ ì—¬ë°± (ê³ ì • ë²„íŠ¼ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡) */
    .order-table-container {
      margin-bottom: 120px;
    }

    /* íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .preview-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .preview-modal-content {
      background: white;
      border-radius: 10px;
      width: 95%;
      max-width: 1200px;
      height: 90%;
      display: flex;
      flex-direction: row;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    /* ì‚¬ì´ë“œë°” ìŠ¤íƒ€ì¼ */
    .preview-sidebar {
      width: 250px;
      background: #f8f9fa;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      border-radius: 10px 0 0 10px;
    }

    .sidebar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #ddd;
      background: #e9ecef;
      border-radius: 10px 0 0 0;
    }

    .sidebar-title {
      margin: 0;
      font-size: 16px;
      color: #495057;
    }

    .file-list {
      height: 540px;
      overflow-y: auto;
      padding: 10px 0;
    }

    .file-item {
      padding: 8px 15px;
      cursor: pointer;
      border-bottom: 1px solid #e9ecef;
      transition: background-color 0.2s;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .file-item:hover {
      background-color: #e9ecef;
    }

    .file-item.active {
      background-color: #007bff;
      color: white;
    }

    .file-icon {
      font-size: 16px;
    }

    .file-name {
      flex: 1;
      font-size: 12px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .delete-file-btn {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 14px;
      padding: 2px 4px;
      border-radius: 3px;
      transition: background-color 0.2s;
      opacity: 0.7;
    }

    .delete-file-btn:hover {
      background-color: #dc3545;
      color: white;
      opacity: 1;
    }

    /* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ */
    .preview-main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #ddd;
      background: #f8f9fa;
    }

    .preview-header h3 {
      margin: 0;
      font-size: 16px;
      color: #333;
    }

    .close-btn {
      background: transparent;
      color: #333;
      border: none;
      border-radius: 0;
      width: 30px;
      height: 30px;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .close-btn:hover {
      background: #f8f9fa;
      color: #000;
    }

    .preview-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 20px;
      background: #f8f9fa;
      border-bottom: 1px solid #ddd;
    }

    .nav-btn {
      background: #007bff;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .nav-btn:hover {
      background: #0056b3;
    }

    .nav-btn:disabled {
      background: #007bff;
      opacity: 0.5;
      cursor: not-allowed;
    }

    .download-btn {
      background: #28a745;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .download-btn:hover {
      background: #218838;
    }

    #fileCounter {
      font-weight: bold;
      color: #333;
    }

    .preview-body {
      flex: 1;
      padding: 20px;
      overflow: auto;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .preview-iframe-container {
      width: 100%;
      max-width: 800px;
      height: 600px;
      border: 1px solid #ddd;
      border-radius: 5px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .preview-iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .preview-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-top: 1px solid #ddd;
      background: #f8f9fa;
      border-radius: 0 0 10px 10px;
    }

  </style>
</head>
<body>
<div class="page">
  <h1>ì„¸ë¬´ìë£Œ</h1>

  <div class="top-menu">
    <!-- ì™¼ìª½: Home, Year -->
    <div class="left-menu">
      <button type="button" onclick="location.href='eltrokorea9.html'" class="top-menu-btn">Home</button>
      
      <!-- ë…„ë„ ì„ íƒ ë²„íŠ¼ -->
      <button type="button" id="yearDownBtn" class="top-menu-btn year-btn">â–¼</button>
      <span id="yearDisplay" class="year-display">2024</span>
      <button type="button" id="yearUpBtn" class="top-menu-btn year-btn">â–²</button>
    </div>
    <!-- ì˜¤ë¥¸ìª½: ë¹ˆ ê³µê°„ (NT, SM ë²„íŠ¼ ì œê±°) -->
    <div class="right-menu">
    </div>
  </div>

  <div class="order-table-container">
    <table id="orderTable">
      <thead>
        <tr>
          <th>ë§¤ì›”</th>
          <th>2ì›”</th>
          <th>3ì›”</th>
          <th>(1-3ì›”)4ì›”</th>
          <th>(4-6ì›”)7ì›”</th>
          <th>(7-9ì›”)10ì›”</th>
          <th>(10-12ì›”)1ì›”</th>
        </tr>
      </thead>
      <tbody id="orderTableBody">
        <tr>
          <td>ê¸‰ì—¬ì‹ ê³ (25ì¼ë°œì†¡)</td>
          <td>ì—°ë§ì •ì‚°(15ì¼)</td>
          <td>ë²•ì¸ì„¸(15ì¼)</td>
          <td>ë¶€ê°€ì„¸(25ì¼ê¸°í•œ)</td>
          <td>ë¶€ê°€ì„¸(25ì¼ê¸°í•œ)</td>
          <td>ë¶€ê°€ì„¸(25ì¼ê¸°í•œ)</td>
          <td>ë¶€ê°€ì„¸(25ì¼ê¸°í•œ)</td>
        </tr>
        <tr>
          <td>ê¸‰ì—¬ë‚´ì—­ì„œ</td>
          <td>ì—°ë§ì •ì‚°ê°„ì†Œí™”ì„œë¹„ìŠ¤</td>
          <td>í†µì¥ê±°ë˜ë‚´ì—­</td>
          <td>ì…ì¶œê¸ˆë‚´ì—­ì„œ</td>
          <td>ì…ì¶œê¸ˆë‚´ì—­ì„œ</td>
          <td>ì…ì¶œê¸ˆë‚´ì—­ì„œ</td>
          <td>ì…ì¶œê¸ˆë‚´ì—­ì„œ</td>
        </tr>
        <tr>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>(í™ˆí…ìŠ¤)</td>
          <td>(ì€í–‰)</td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
        </tr>
        <tr>
          <td></td>
          <td>ê·¼ë¡œì†Œë“ì›ì²œì§•ìˆ˜</td>
          <td>ì›ì²œì§•ìˆ˜ë‚´ì—­ì„œ</td>
          <td>ìˆ˜ì…ì›ê°€ëª…ì„¸ì„œ</td>
          <td>ìˆ˜ì…ì›ê°€ëª…ì„¸ì„œ</td>
          <td>ìˆ˜ì…ì›ê°€ëª…ì„¸ì„œ</td>
          <td>ìˆ˜ì…ì›ê°€ëª…ì„¸ì„œ</td>
        </tr>
        <tr>
          <td></td>
          <td>(í™˜ê¸‰ë‚´ì—­ì˜ìˆ˜ì¦)</td>
          <td>(ì€í–‰,ì¦ê¶Œì‚¬)</td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>ìì‚°/ì£¼ì£¼ë³€ë™ë‚´ì—­</td>
          <td>ì„¸ê¸ˆê³„ì‚°ì„œ</td>
          <td>ì„¸ê¸ˆê³„ì‚°ì„œ</td>
          <td>ì„¸ê¸ˆê³„ì‚°ì„œ</td>
          <td>ì„¸ê¸ˆê³„ì‚°ì„œ</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
          <td>
            <button class="top-menu-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ì—…ë¡œë“œ">ğŸ“¤</button>
            <button class="top-menu-btn preview-btn" style="padding: 2px 4px; margin: 0 1px; border: 1px solid #ccc; border-radius: 2px; background: #fff; cursor: pointer; font-size: 10px; min-width: 20px; height: 20px; line-height: 1;" title="ë¯¸ë¦¬ë³´ê¸°">ğŸ‘ï¸</button>
          </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>ì™¸í™”ì…ê¸ˆë‚´ì—­í™•ì¸ì„œ</td>
          <td>ì™¸í™”ì…ê¸ˆë‚´ì—­í™•ì¸ì„œ</td>
          <td>ì™¸í™”ì…ê¸ˆë‚´ì—­í™•ì¸ì„œ</td>
          <td>ì™¸í™”ì…ê¸ˆë‚´ì—­í™•ì¸ì„œ</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>(ì€í–‰)</td>
          <td>(ì€í–‰)</td>
          <td>(ì€í–‰)</td>
          <td>(ì€í–‰)</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ -->
<div id="previewModal" class="preview-modal" style="display: none;">
  <div class="preview-modal-content">
    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°” -->
    <div class="preview-sidebar">
      <div class="sidebar-header">
        <h3 class="sidebar-title">ğŸ“ íŒŒì¼ ëª©ë¡</h3>
        <div></div>
      </div>
      <div class="file-list" id="fileList">
        <!-- íŒŒì¼ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
      </div>
    </div>
    
    <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
    <div class="preview-main">
      <div class="preview-header">
        <h3 id="previewTitle">íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°</h3>
        <button id="closePreviewBtn" class="close-btn">&times;</button>
      </div>
      <div class="preview-navigation">
        <button id="prevFileBtn" class="nav-btn">â¬…ï¸ ì´ì „</button>
        <span id="fileCounter">1 / 1</span>
        <button id="nextFileBtn" class="nav-btn">ë‹¤ìŒ â¡ï¸</button>
      </div>
      <div class="preview-body">
        <div class="preview-iframe-container">
          <iframe id="previewFrame" class="preview-iframe" src="" frameborder="0"></iframe>
        </div>
      </div>
      <div class="preview-footer">
        <div></div>
        <button id="downloadCurrentBtn" class="download-btn">ğŸ“¥ ë‹¤ìš´ë¡œë“œ</button>
      </div>
    </div>
  </div>
</div>

<!-- í•˜ë‹¨ ë²„íŠ¼ ì˜ì—­ - order.htmlê³¼ ë™ì¼í•œ êµ¬ì¡° -->
<div class="bottom-buttons">
  <!-- í™•ì¥/ì¶•ì†Œ ë²„íŠ¼ (ì„œë ì†ì¡ì´ì²˜ëŸ¼ ìœ„ìª½ì— íŠ€ì–´ë‚˜ì˜´) -->
  <div class="expand-handle">
    <button id="expandButton" type="button" class="expand-btn">â–¼</button>
  </div>
  
  <!-- ê¸°ë³¸ ë²„íŠ¼ ì˜ì—­ (í•­ìƒ ë³´ì„) -->
  <div class="main-button-group">
  </div>

  <!-- í™•ì¥ ê°€ëŠ¥í•œ ìƒì„¸ ë²„íŠ¼ ì˜ì—­ (ê¸°ë³¸ì ìœ¼ë¡œ ìˆ¨ê¹€) -->
  <div id="detailButtonArea" class="detail-button-area" style="display: none;">
    <!-- í•„ìš”ì‹œ ì¶”ê°€ ë²„íŠ¼ë“¤ -->
  </div>
</div>

<script>
        // URL íŒŒë¼ë¯¸í„°ì—ì„œ ë…„ë„ ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search);
        const urlYear = urlParams.get('year');

        // ë…„ë„ ì„ íƒ ì´ˆê¸°í™”
        let currentYear = urlYear ? parseInt(urlYear) : new Date().getFullYear();

        const yearDisplay = document.getElementById("yearDisplay");
        const yearUpBtn = document.getElementById("yearUpBtn");
        const yearDownBtn = document.getElementById("yearDownBtn");
        const previewModal = document.getElementById('previewModal');

        yearDisplay.textContent = currentYear;

        // ë…„ë„ ë³€ê²½ ì‹œ ê³µí†µ ì²˜ë¦¬ í•¨ìˆ˜
        const handleYearChange = () => {
            // ì—´ë ¤ìˆëŠ” ëª¨ë‹¬ ë‹«ê¸°
            if (previewModal && previewModal.style.display !== 'none') {
                previewModal.style.display = 'none';
            }
            // ëª¨ë“  ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì¬ì—…ë°ì´íŠ¸
            updateAllPreviewButtons();
        };

        // ë…„ë„ ì¦ê°€ ë²„íŠ¼
        yearUpBtn.addEventListener("click", () => {
            currentYear++;
            yearDisplay.textContent = currentYear;
            handleYearChange();
        });

        // ë…„ë„ ê°ì†Œ ë²„íŠ¼
        yearDownBtn.addEventListener("click", () => {
            if (currentYear > 2020) {
                currentYear--;
                yearDisplay.textContent = currentYear;
                handleYearChange();
            }
        });

        // í™•ì¥/ì¶•ì†Œ ê¸°ëŠ¥
        const expandBtn = document.getElementById("expandButton");
        const detailArea = document.getElementById("detailButtonArea");
        expandBtn.addEventListener("click", () => {
            if (detailArea.style.display === "none") {
                detailArea.style.display = "flex";
                expandBtn.classList.add("expanded");
                expandBtn.textContent = "â–²";
            } else {
                detailArea.style.display = "none";
                expandBtn.classList.remove("expanded");
                expandBtn.textContent = "â–¼";
            }
        });

        // ë²„íŠ¼ ìœ„ì¹˜ ì •ë³´ ì¶”ì¶œ ê³µí†µ í•¨ìˆ˜
        function getButtonPositionInfo(button) {
            const buttonCell = button.closest('td');
            const buttonRow = button.closest('tr');
            const cellIndex = Array.from(buttonRow.cells).indexOf(buttonCell);
            
            // í—¤ë” ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
            const headerRow = document.querySelector('#orderTable thead tr');
            const headerName = headerRow.cells[cellIndex].textContent.trim();
            
            // ë²„íŠ¼ ë°”ë¡œ ìœ„ í–‰ì—ì„œ í•´ë‹¹ ì—´ì˜ ë‚´ìš© ê°€ì ¸ì˜¤ê¸° (í–‰ ì´ë¦„)
            const parentChildren = Array.from(buttonRow.parentElement.children);
            const rowIndex = parentChildren.indexOf(buttonRow);
            const previousRow = parentChildren[rowIndex - 1];
            const rowName = previousRow ? previousRow.cells[cellIndex].textContent.trim() : '';
            
            return { buttonCell, buttonRow, cellIndex, headerName, rowName };
        }

        // íŒŒì¼ ì—…ë¡œë“œ í•¨ìˆ˜ (ì„¸ë¬´ìë£Œìš©)
        function uploadTaxFile(button) {
            // ë²„íŠ¼ì˜ ìœ„ì¹˜ ì •ë³´ ì¶”ì¶œ
            const { buttonCell, headerName, rowName } = getButtonPositionInfo(button);
            
            if (!rowName) {
                alert('í–‰ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // íŒŒì¼ ì…ë ¥ ìš”ì†Œ ìƒì„±
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.pdf,.doc,.docx,.jpg,.jpeg,.png,.txt';
            fileInput.style.display = 'none';
            
            // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            fileInput.addEventListener('change', async function(event) {
                const file = event.target.files[0];
                if (!file) {
                    return;
                }
                
                try {
                    // FormData ìƒì„±
                    const formData = new FormData();
                    formData.append('file', file);
                    formData.append('mode', 'ì„¸ë¬´ìë£Œ');
                    formData.append('year', currentYear.toString());
                    formData.append('headerName', headerName);
                    formData.append('rowName', rowName);
                    formData.append('originalFileName', file.name);
                    
                    // ì„œë²„ë¡œ ì—…ë¡œë“œ
                    const response = await fetch('/api/uploadFile', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        alert(`íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.\nê²½ë¡œ: ì„¸ë¬´ìë£Œ/${currentYear}/${headerName}/${rowName}`);
                        
                        // ì—…ë¡œë“œ ì„±ê³µ í›„ ê°™ì€ ì…€ì˜ ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
                        const previewButton = buttonCell.querySelector('.preview-btn');
                        if (previewButton) {
                            updatePreviewButtonStyle(previewButton, headerName, rowName);
                        }
                    } else {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                } catch (error) {
                    console.error('[UPLOAD] ì—…ë¡œë“œ ì‹¤íŒ¨:', error);
                    alert(`íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nì—ëŸ¬: ${error.message}`);
                }
                
                // íŒŒì¼ ì…ë ¥ ìš”ì†Œ ì œê±°
                document.body.removeChild(fileInput);
            });
            
            // íŒŒì¼ ì…ë ¥ ìš”ì†Œë¥¼ DOMì— ì¶”ê°€í•˜ê³  í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒ
            document.body.appendChild(fileInput);
            fileInput.click();
        }
        
        // íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° í•¨ìˆ˜ (ì„¸ë¬´ìë£Œìš©)
        function viewTaxFile(button) {
            // ë²„íŠ¼ì˜ ìœ„ì¹˜ ì •ë³´ ì¶”ì¶œ
            const { headerName, rowName } = getButtonPositionInfo(button);
            
            if (!rowName) {
                alert('í–‰ ì´ë¦„ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì„œë²„ì—ì„œ íŒŒì¼ ëª©ë¡ ì¡°íšŒ
            fetch(`/api/listFiles/tax/${currentYear}/${encodeURIComponent(headerName)}/${encodeURIComponent(rowName)}`)
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                })
                .then(data => {
                    if (data.files && data.files.length > 0) {
                        // íŒŒì¼ ëª©ë¡ ì €ì¥
                        currentFiles = data.files;
                        currentFileIndex = 0;
                        currentHeaderName = headerName;
                        currentRowName = rowName;
                        
                        // ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ í‘œì‹œ
                        showPreviewModal();
                    } else {
                        alert('íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.');
                    }
                })
                .catch(error => {
                    console.error('[VIEW] íŒŒì¼ ì¡°íšŒ ì‹¤íŒ¨:', error);
                    alert(`íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nì—ëŸ¬: ${error.message}`);
                });
        }
        
        // íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ì „ì—­ ë³€ìˆ˜
        let currentFiles = [];
        let currentFileIndex = 0;
        let currentHeaderName = '';
        let currentRowName = '';
        
        // íŒŒì¼ í™•ì¥ì ì¶”ì¶œ ê³µí†µ í•¨ìˆ˜
        function getFileExtension(filename) {
            return filename.split('.').pop().toLowerCase();
        }
        
        // íŒŒì¼ ì•„ì´ì½˜ ê²°ì • í•¨ìˆ˜
        function getFileIcon(filename) {
            const fileExtension = getFileExtension(filename);
            if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) return 'ğŸ–¼ï¸';
            if (['doc', 'docx'].includes(fileExtension)) return 'ğŸ“';
            if (['xls', 'xlsx'].includes(fileExtension)) return 'ğŸ“Š';
            return 'ğŸ“„'; // ê¸°ë³¸ê°’ (PDF í¬í•¨)
        }
        
        // ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ í‘œì‹œ
        function showPreviewModal() {
            const modal = document.getElementById('previewModal');
            const title = document.getElementById('previewTitle');
            const fileList = document.getElementById('fileList');
            
            // ì œëª© ì„¤ì •
            title.textContent = `íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° (${currentHeaderName} - ${currentRowName})`;
            
            // ì‚¬ì´ë“œë°”ì— íŒŒì¼ ëª©ë¡ ìƒì„±
            fileList.innerHTML = '';
            currentFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = `file-item ${index === currentFileIndex ? 'active' : ''}`;
                fileItem.onclick = () => selectFile(index);
                
                fileItem.innerHTML = `
                    <span class="file-icon">${getFileIcon(file.filename)}</span>
                    <span class="file-name" title="${file.filename}">${file.filename}</span>
                    <button class="delete-file-btn" onclick="deleteFile(event, ${index})" title="íŒŒì¼ ì‚­ì œ">ğŸ—‘ï¸</button>
                `;
                
                fileList.appendChild(fileItem);
            });
            
            // ì²« ë²ˆì§¸ íŒŒì¼ í‘œì‹œ (ì¹´ìš´í„° ì—…ë°ì´íŠ¸ í¬í•¨)
            showCurrentFile();
            
            // ëª¨ë‹¬ í‘œì‹œ
            modal.style.display = 'flex';
        }
        
        // ì‚¬ì´ë“œë°”ì—ì„œ íŒŒì¼ ì„ íƒ
        function selectFile(index) {
            if (index >= 0 && index < currentFiles.length) {
                currentFileIndex = index;
                showCurrentFile();
                updateFileList();
                updateNavigationButtons();
            }
        }
        
        // íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸ (í™œì„± íŒŒì¼ í‘œì‹œ)
        function updateFileList() {
            const fileItems = document.querySelectorAll('.file-item');
            fileItems.forEach((item, index) => {
                if (index === currentFileIndex) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        
        // í˜„ì¬ íŒŒì¼ í‘œì‹œ
        function showCurrentFile() {
            if (currentFiles.length === 0) return;
            
            const currentFile = currentFiles[currentFileIndex];
            const previewFrame = document.getElementById('previewFrame');
            const counter = document.getElementById('fileCounter');
            
            // íŒŒì¼ í™•ì¥ì í™•ì¸
            const fileExtension = getFileExtension(currentFile.filename);
            
            // ë¯¸ë¦¬ë³´ê¸° ì „ìš© API ì‚¬ìš©
            const previewUrl = `/api/previewFile/tax/${currentYear}/${encodeURIComponent(currentHeaderName)}/${encodeURIComponent(currentRowName)}/${encodeURIComponent(currentFile.filename)}`;
            
            // PDF, ì´ë¯¸ì§€ íŒŒì¼ì˜ ê²½ìš° ì§ì ‘ ë¯¸ë¦¬ë³´ê¸°
            if (['pdf', 'jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                previewFrame.src = previewUrl;
            }
            // ê¸°íƒ€ íŒŒì¼ì˜ ê²½ìš° ë‹¤ìš´ë¡œë“œ ë§í¬ í‘œì‹œ
            else {
                const downloadUrl = `/api/downloadFile/tax/${currentYear}/${encodeURIComponent(currentHeaderName)}/${encodeURIComponent(currentRowName)}/${encodeURIComponent(currentFile.filename)}`;
                previewFrame.src = `data:text/html,<html><body style="text-align:center;padding:50px;font-family:Arial;">
                    <h3>ë¯¸ë¦¬ë³´ê¸° ë¶ˆê°€ëŠ¥í•œ íŒŒì¼ í˜•ì‹</h3>
                    <p>íŒŒì¼ëª…: ${currentFile.filename}</p>
                    <p>í¬ê¸°: ${(currentFile.size / 1024).toFixed(1)} KB</p>
                    <a href="${downloadUrl}" style="background:#007bff;color:white;padding:10px 20px;text-decoration:none;border-radius:5px;">ğŸ“¥ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</a>
                </body></html>`;
            }
            
            // ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            counter.textContent = `${currentFileIndex + 1} / ${currentFiles.length}`;
            
            // ì‚¬ì´ë“œë°” íŒŒì¼ ëª©ë¡ ì—…ë°ì´íŠ¸
            updateFileList();
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateNavigationButtons();
        }
        
        // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevFileBtn');
            const nextBtn = document.getElementById('nextFileBtn');
            
            if (prevBtn) prevBtn.disabled = currentFileIndex === 0;
            if (nextBtn) nextBtn.disabled = currentFileIndex === currentFiles.length - 1;
        }
        
        // íŒŒì¼ ì‚­ì œ í•¨ìˆ˜
        async function deleteFile(event, fileIndex) {
            event.stopPropagation(); // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸ ë°©ì§€
            
            if (currentFiles.length === 0 || fileIndex >= currentFiles.length) {
                return;
            }
            
            const fileToDelete = currentFiles[fileIndex];
            const confirmDelete = confirm(`íŒŒì¼ "${fileToDelete.filename}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
            
            if (!confirmDelete) {
                return;
            }
            
            try {
                // ì„œë²„ì— íŒŒì¼ ì‚­ì œ ìš”ì²­
                const response = await fetch(`/api/deleteFile/tax/${currentYear}/${encodeURIComponent(currentHeaderName)}/${encodeURIComponent(currentRowName)}/${encodeURIComponent(fileToDelete.filename)}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    alert('íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    
                    // ì‚­ì œ ì„±ê³µ í›„ íŒŒì¼ ëª©ë¡ì—ì„œ ì œê±°
                    currentFiles.splice(fileIndex, 1);
                    
                    if (currentFiles.length === 0) {
                        // íŒŒì¼ì´ ì—†ìœ¼ë©´ ëª¨ë‹¬ ë‹«ê¸°
                        document.getElementById('previewModal').style.display = 'none';
                        
                        // í•´ë‹¹ ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸ (í•˜ëŠ˜ìƒ‰ â†’ í°ìƒ‰)
                        updatePreviewButtonForDeletedFile(currentHeaderName, currentRowName);
                    } else {
                        // í˜„ì¬ ì¸ë±ìŠ¤ ì¡°ì •
                        if (currentFileIndex >= currentFiles.length) {
                            currentFileIndex = currentFiles.length - 1;
                        }
                        // íŒŒì¼ ëª©ë¡ ë° ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                        const fileList = document.getElementById('fileList');
                        fileList.innerHTML = '';
                        currentFiles.forEach((file, index) => {
                            const fileItem = document.createElement('div');
                            fileItem.className = `file-item ${index === currentFileIndex ? 'active' : ''}`;
                            fileItem.onclick = () => selectFile(index);
                            
                            fileItem.innerHTML = `
                                <span class="file-icon">${getFileIcon(file.filename)}</span>
                                <span class="file-name" title="${file.filename}">${file.filename}</span>
                                <button class="delete-file-btn" onclick="deleteFile(event, ${index})" title="íŒŒì¼ ì‚­ì œ">ğŸ—‘ï¸</button>
                            `;
                            
                            fileList.appendChild(fileItem);
                        });
                        // í˜„ì¬ íŒŒì¼ í‘œì‹œ (ì¹´ìš´í„° ë° ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ ì—…ë°ì´íŠ¸ í¬í•¨)
                        showCurrentFile();
                    }
                } else {
                    const errorData = await response.json();
                    alert(`íŒŒì¼ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${errorData.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
                }
            } catch (error) {
                console.error('íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜:', error);
                alert(`íŒŒì¼ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${error.message}`);
            }
        }
        
        // íŒŒì¼ ì‚­ì œ í›„ í•´ë‹¹ ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        function updatePreviewButtonForDeletedFile(headerName, rowName) {
            // ëª¨ë“  ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìˆœíšŒ
            const previewButtons = document.querySelectorAll('.preview-btn');
            previewButtons.forEach(button => {
                const { headerName: buttonHeaderName, rowName: buttonRowName } = getButtonPositionInfo(button);
                
                // ì¼ì¹˜í•˜ëŠ” ë²„íŠ¼ ì°¾ê¸°
                if (buttonHeaderName === headerName && buttonRowName === rowName) {
                    // íŒŒì¼ì´ ì—†ìœ¼ë¯€ë¡œ í° ë°°ê²½ìœ¼ë¡œ ë³€ê²½
                    button.style.background = '#fff';
                    button.style.color = 'black';
                }
            });
        }
        
        // ëª¨ë“  ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸ (ë…„ë„ ë³€ê²½ ì‹œ ì‚¬ìš©)
        async function updateAllPreviewButtons() {
            const previewButtons = document.querySelectorAll('.preview-btn');
            for (const button of previewButtons) {
                const { headerName, rowName } = getButtonPositionInfo(button);
                
                if (rowName) {
                    await updatePreviewButtonStyle(button, headerName, rowName);
                }
            }
        }
        
        // ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        async function updatePreviewButtonStyle(button, headerName, rowName) {
            try {
                const response = await fetch(`/api/listFiles/tax/${currentYear}/${encodeURIComponent(headerName)}/${encodeURIComponent(rowName)}`);
                if (response.ok) {
                    const data = await response.json();
                    if (data.files && data.files.length > 0) {
                        // íŒŒì¼ì´ ìˆìœ¼ë©´ ì—°í•œ íŒŒë€ ë°°ê²½
                        button.style.background = '#87CEEB';
                        button.style.color = 'white';
                        return;
                    }
                }
                // íŒŒì¼ì´ ì—†ê±°ë‚˜ 404ì¸ ê²½ìš° í° ë°°ê²½
                button.style.background = '#fff';
                button.style.color = 'black';
            } catch (error) {
                // ì—ëŸ¬ëŠ” ë¬´ì‹œ (íŒŒì¼ì´ ì—†ëŠ” ê²½ìš°ê°€ ë§ìœ¼ë¯€ë¡œ)
                // console.error('íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ì‹¤íŒ¨:', error);
            }
        }
        
        // ëª¨ë“  ë²„íŠ¼ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
        document.addEventListener('DOMContentLoaded', () => {
            // ì—…ë¡œë“œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const uploadButtons = document.querySelectorAll('#orderTable tbody button:not(.preview-btn)');
            uploadButtons.forEach(button => {
                if (button.textContent.includes('ğŸ“¤')) {
                    button.addEventListener('click', function() {
                        uploadTaxFile(this);
                    });
                }
            });
            
            // ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const previewButtons = document.querySelectorAll('.preview-btn');
            previewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    viewTaxFile(this);
                });
                
                // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
                const { headerName, rowName } = getButtonPositionInfo(button);
                
                if (rowName) {
                    updatePreviewButtonStyle(button, headerName, rowName);
                }
            });
            
            // ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('closePreviewBtn').addEventListener('click', () => {
                document.getElementById('previewModal').style.display = 'none';
            });
            
            document.getElementById('prevFileBtn').addEventListener('click', () => {
                if (currentFileIndex > 0) {
                    currentFileIndex--;
                    showCurrentFile();
                }
            });
            
            document.getElementById('nextFileBtn').addEventListener('click', () => {
                if (currentFileIndex < currentFiles.length - 1) {
                    currentFileIndex++;
                    showCurrentFile();
                }
            });
            
            document.getElementById('downloadCurrentBtn').addEventListener('click', () => {
                if (currentFiles.length > 0) {
                    const currentFile = currentFiles[currentFileIndex];
                    const fileUrl = `/api/downloadFile/tax/${currentYear}/${encodeURIComponent(currentHeaderName)}/${encodeURIComponent(currentRowName)}/${encodeURIComponent(currentFile.filename)}`;
                    
                    // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
                    const link = document.createElement('a');
                    link.href = fileUrl;
                    link.download = currentFile.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
            });
            
            // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            document.getElementById('previewModal').addEventListener('click', (e) => {
                if (e.target.id === 'previewModal') {
                    document.getElementById('previewModal').style.display = 'none';
                }
            });
        });

</script>
</body>
</html>

